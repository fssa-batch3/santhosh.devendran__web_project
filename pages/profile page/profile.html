<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="../../assets/css/font style.css" />
    <title>profile</title>
    <link rel="stylesheet" href="../../assets/css/profile css/profile.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <!-- header -->
    <main>

        <section class="left_side">
            <div class="center">

                <div class="profile_top">
                    <div class="back_button">
                        <a href="../home.html"><i class="fa fa-arrow-left" style="font-size:24px"></i></a>
                    </div>
                    <div class="user">
                        <span><b id="tname"></b></span>
                        <p class="post_count"> 124 posts</p>
                    </div>
                    <div class="d_bn">
                        <button class="delete_bn" onclick="deletData(event)">delete</button>
                        <button class="logout_bn" onclick="logout(event)">log out</button>
                    </div>
                </div>

                <div class="profile_photo">
                    <div class="cover_img">
                        <img alt="cover photo" src="" width="100%" height="250px" />
                    </div>

                    <!-- ../../assets/img/user/cover img/profile back cover.jpg
                    ../../assets/img/user/DS profile img.jpg -->
                    <div class="dp">
                        <img alt="profile image" src="" width="130px" height="130px" />
                    </div>
                </div>
                <div class="user_details">

                    <h2 class="username" id="name"></h2>
                    <p class="unicname" id="user_name"></p>
                    <h3 class="bio">Bio</h3>
                    <div class="about_user">
                        <p id="bio"></p>
                    </div>
                    <div class="birth">
                        <p id="dob">Born</p>
                    </div>
                </div>

                <div class="follower_count">
                    <span><b>08</b>
                        <p class="gray">followers</p>
                    </span>
                    <span><b>04</b>
                        <p class="gray">following</p>
                    </span>
                </div>
                <div class="bn">
                    <a id="edit_bn_page" ><button class="edit edit_bn">edit</button></a><button id="follow_bn" class="edit follow_bn">follow</button>

                </div>

            </div>

            <div class="postandlikes">
                <a href="./profile.html">
                    <h2 class="hilight">posts</h2>
                </a>
                <a href="./profile - liked.html">
                    <h2 class="likes">likes</h2>
                </a>
            </div>

            <!-- 
            <div class="post">
                <div class="user_list">
                    <div class="img">
                        <img alt="profile" class="profile_img" src="../../assets/img/user/DS profile img.jpg"
                            width="50px" height="50px" />
                    </div>
                    <div class="user">
                        <p class="user_name">Santhosh D </p> <span class="delete"><button
                                class="deletebn">Delete</button></span>
                        <p class="post_cuntent">So true ðŸ¥°</p>
                    </div>
                </div>

                <div class="post_img">
                    <img alt="post" src="../../assets/img/my posts/post 1.jpg" />
                </div>

                <div class="like_comand">
                    <div class="like">
                        <a><i class="fa fa-heart-o" style="font-size:18px;color: black;"></i></a>
                        <span class="like_count">2</span>
                    </div>
                    <a href="../post details/santhosh d/comment - post1.html">
                        <div class="comand">
                            <i class='fa fa-comment-o' style='font-size:18px;color: black;'></i>
                            <span class="like_count">2</span>
                        </div>
                    </a>

                </div>
            </div>

            <div class="post">
                <div class="user_list">
                    <div class="img">
                        <img alt="profile" class="profile_img" src="../../assets/img/user/DS profile img.jpg"
                            width="50px" height="50px" />
                    </div>
                    <div class="user">
                        <p class="user_name">Santhosh D</p>
                        <span class="delete"><button class="deletebn">Delete</button></span>
                        <p class="post_cuntent">Thala Ajith drops the tag "Thala" ðŸ¥²
                        </p>
                    </div>
                </div>
                <div class="like_comand">
                    <div class="like">
                        <a><i class="fa fa-heart-o" style="font-size:18px;color: black;"></i></a>
                        <span class="like_count">2</span>
                    </div>
                    <a href="../post details/santhosh d/comment - post2.html">
                        <div class="comand">
                            <i class='fa fa-comment-o' style='font-size:18px;color: black;'></i>
                            <span class="like_count">2</span>
                        </div>
                    </a>
                </div>
            </div>

            <div class="post">
                <div class="user_list">
                    <div class="img">
                        <img alt="profile" class="profile_img" src="../../assets/img/user/DS profile img.jpg"
                            width="50px" height="50px" />
                    </div>
                    <div class="user">
                        <p class="user_name">Santhosh D</p> 
                        <span class="delete"><button class="deletebn">Delete</button></span>
                        <p class="post_cuntent">He Is COMING ðŸ”¥ðŸ¥µ AK Power ðŸ¥µ</p>
                    </div>
                </div>

                <div class="post_img">
                    <img alt="post" src="../../assets/img/my posts/post 2.jpg" />
                </div>

                <div class="like_comand">
                    <div class="like">
                        <a><i class="fa fa-heart-o" style="font-size:18px;color: black;"></i></a>
                        <span class="like_count">2</span>
                    </div>
                    <a href="../post details/santhosh d/comment - post3.html">
                        <div class="comand">
                            <i class='fa fa-comment-o' style='font-size:18px;color: black;'></i>
                            <span class="like_count">2</span>
                        </div>
                    </a>
                </div>
            </div>

            <div class="post">
                <div class="user_list">
                    <div class="img">
                        <img alt="profile" class="profile_img" src="../../assets/img/user/DS profile img.jpg"
                            width="50px" height="50px" />
                    </div>
                    <div class="user">
                        <p class="user_name">Santhosh D</p> <span class="delete"><button
                                class="deletebn">Delete</button></span>
                        <p class="post_cuntent">
                            <span class="tag">#social media</span>

                            Doorstep cross 1.3b download
                            in play store
                            <span class="tag">#top10</span>
                        </p>
                    </div>
                </div>
                <div class="like_comand">
                    <div class="like">
                        <a><i class="fa fa-heart-o" style="font-size:18px;color: black;"></i></a>
                        <span class="like_count">2</span>
                    </div>
                    <a href="../post details/santhosh d/comment - post4.html">
                        <div class="comand">
                            <i class='fa fa-comment-o' style='font-size:18px;color: black;'></i>
                            <span class="like_count">2</span>
                        </div>
                    </a>
                </div>
            </div> -->
        </section>




        <section class="right_side">

            <div class="right_top">

                <h2 class="heading">Trending</h2>
                <div class="top">
                    <div class="hash">
                        <div class="hex">
                            <span class="hex_code">#</span>
                        </div>
                        <div class="topic_list">
                            <p class="topic">Election in india</p>

                        </div>
                    </div>
                    <div class="interest">
                        <a href=""><img alt="img" src="../../assets/img/thumps up.png" class="intrest img" width="30px"
                                height="30px" /></a>
                    </div>
                </div>

                <div class="top">
                    <div class="hash">
                        <div class="hex">
                            <span class="hex_code">#</span>
                        </div>
                        <div class="topic_list">
                            <p class="topic">russia ukrain war</p>

                        </div>
                    </div>
                    <div class="interest">
                        <a href=""><img alt="img" src="../../assets/img/thumps up.png" class="intrest img" width="30px"
                                height="30px" /></a>
                    </div>
                </div>

            </div>
            <div class="right_bottom">
                <h2 class="heading right_bottom">Who to follow</h2>
                <!-- <div class="top_user">
                    <div class="img">
                        <a href="../profile page/user profile/elon musk.html"><img alt="profile" class="profile_img"
                                src="../../assets/img/user/elon musk.jpg" width="50px" height="50px" /></a>
                    </div>
                    <div class="user_list">
                        <a href="../profile page/user profile/elon musk.html">
                            <p class="user_name">Elon Musk</p><span class="gray">@elon2453</span>
                        </a>

                    </div>
                    <div class="follow_button">
                        <button>follow</button>
                    </div>
                </div>

                <div class="top_user">
                    <div class="img">
                        <a href="../profile page/user profile/Freshworks Inc.html"><img alt="profile"
                                class="profile_img" src="../../assets/img/user/freshworks.jpg" width="50px"
                                height="50px" /></a>
                    </div>
                    <div class="user_list">
                        <a href="../profile page/user profile/Freshworks Inc.html">
                            <p class="user_name">Freshworks Inc</p><span class="gray">@freshwork2010</span>
                        </a>

                    </div>
                    <div class="follow_button">
                        <button>follow</button>
                    </div>
                </div>

                <div class="top_user">
                    <div class="img">
                        <a href="../profile page/user profile/Girish Mathrubootham.html"><img alt="profile"
                                class="profile_img" src="../../assets/img/user/girish sir.jpg" width="50px"
                                height="50px" /></a>
                    </div>
                    <div class="user_list">
                        <a href="../profile page/user profile/Girish Mathrubootham.html">
                            <p class="user_name">Girish Mathrubootham</p><span class="gray">@girishfwceo</span>
                        </a>

                    </div>
                    <div class="follow_button">
                        <button>follow</button>
                    </div>
                </div>

                <div class="top_user">
                    <div class="img">
                        <a href="../profile page/user profile/HVinoth.html"><img alt="profile" class="profile_img"
                                src="../../assets/img/user/hvinoth.jpg" width="50px" height="50px" /></a>
                    </div>
                    <div class="user_list">
                        <a href="../profile page/user profile/HVinoth.html">
                            <p class="user_name">HVinoth</p><span class="gray">@hvinoth3462</span>
                        </a>

                    </div>
                    <div class="follow_button">
                        <button>follow</button>
                    </div>
                </div> -->

            </div>

        </section>


    </main><a href="../profile page/edit profile.html"></a>

    <script src="../../assets/js/header.js"></script>




    <script>

        

        let unic_user_id = JSON.parse(localStorage.getItem("user_id"));

        if(unic_user_id==""){
            window.location.href = "../../index.html";
        }


        
        const params = new URLSearchParams(window.location.search);
        const user_Id = params.get('user_id');


        const edit_bn=document.getElementsByClassName("edit_bn");
        const follow_bn=document.getElementsByClassName("follow_bn");

        
        if(unic_user_id!==user_Id){
            
                edit_bn[0].style.display = "none";
           
           
                follow_bn[0].style.display = "block";
            
    }
    //  for other user profile/////////////
        if (user_Id !== unic_user_id) {
            let user_records = JSON.parse(localStorage.getItem("user_list"));

            function login_data(e) {
                return e.user_name == user_Id;
            }
            let user_data = user_records.find(login_data);



            let name = user_data["first_name"] + " " + user_data["last_name"]


            document.getElementById("tname").innerHTML = name;
            document.getElementById("name").innerHTML = name;
            document.getElementById("user_name").innerHTML = user_data["user_name"];
            document.getElementById("bio").innerHTML = user_data["user_bio"];
            document.getElementById("dob").innerHTML = "Born in " + user_data["dob"];

            const logout = document.getElementsByClassName("logout_bn");
            if (logout.length > 0) {
                logout[0].style.display = "none";
            }
            const delete_bn = document.getElementsByClassName("delete_bn");
            if (delete_bn.length > 0) {
                delete_bn[0].style.display = "none";
            }

           
            

        }
        //  for login user///////////

        if (user_Id == unic_user_id) {
        
            let user_records = JSON.parse(localStorage.getItem("user_list"));

            function login_data(e) {
                return e.user_name == unic_user_id;
            }
            let user_data = user_records.find(login_data);



            let name = user_data["first_name"] + " " + user_data["last_name"]


            document.getElementById("tname").innerHTML = name;
            document.getElementById("name").innerHTML = name;
            document.getElementById("user_name").innerHTML = user_data["user_name"];
            document.getElementById("bio").innerHTML = user_data["user_bio"];
            document.getElementById("dob").innerHTML = "Born in " + user_data["dob"];

            if (follow_bn.length > 0) {
                follow_bn[0].style.display = "none";
              
            }
            if (edit_bn.length > 0) {
                edit_bn[0].style.display = "block";
            }

        }

        // for follow unfollow button show  //

        const follow_bn_function=document.getElementById("follow_bn");
        let follow_data = JSON.parse(localStorage.getItem('follow_data'));
        let user_f_data=follow_data.find(e=>e.followee==unic_user_id && e.following==user_Id);

            if(user_f_data==undefined){
                follow_bn_function.innerText = "follow";
            }
            else{
                follow_bn_function.innerText = "Unfollow";
            }


            // for follow and Unfollow button feature  ////

            follow_bn_function.addEventListener("click",function(){
                let following=user_Id;
                let followee=unic_user_id;

                let follow_bn=document.getElementById(following);
                let follow_data = JSON.parse(localStorage.getItem('follow_data'))||[];
                if(follow_data.length===0){
                    follow_data.push({
                        "following":following,
                        "followee":followee,
                        "notification":false
                    })
                    console.log(follow_data);
                    follow_bn_function.innerHTML = 'Unfollow';
                    localStorage.setItem("follow_data",JSON.stringify(follow_data));
                }
                else{
                    let user_f_data=follow_data.find(e=>e.followee==unic_user_id && e.following==following);
                let indexOfuser_f=follow_data.indexOf(user_f_data);
                if(user_f_data == undefined){
                    follow_data.push({
                        "following":following,
                        "followee":followee,
                        "notification":false
                    })
                    follow_bn_function.innerText="Unfollow";
                    localStorage.setItem("follow_data",JSON.stringify(follow_data));
                }
                else{
                    follow_data.splice(indexOfuser_f,1);
                    localStorage.setItem("follow_data",JSON.stringify(follow_data));
                    follow_bn_function.innerText="follow";
                }
                }
            });



        //  user edit page
        const edit_button = document.getElementById("edit_bn_page");
        console.log(edit_button);
        edit_button.setAttribute("href", "../profile page/edit profile.html?user_id=" + unic_user_id);


        // function for delete

        function deletData(e) {
            let password_for_delete = prompt("Please enter your password:");
            let check = false;
            let user_records = JSON.parse(localStorage.getItem("user_list"));
            function login_data(e) {
                return e.user_name == unic_user_id;
            }
            let user_data = user_records.find(login_data);
            if (password_for_delete == user_data["password"]) {
                check = true;
            }
            else {
                alert("password is incorect")
            }

            if (check === true) {
                let unic_user_id = JSON.parse(localStorage.getItem("user_id"));
                let user_records = JSON.parse(localStorage.getItem("user_list"));
                function login_data(e) {
                    return e.user_name == unic_user_id;
                }
                let user_data = user_records.find(login_data);

                const indexOfUser = user_records.indexOf(user_data);
                user_records.splice(indexOfUser, 1);
                localStorage.setItem('user_list', JSON.stringify(user_records));
                let user_id="";
                localStorage.setItem('user_id', JSON.stringify(user_id));
                window.location.href = "../../index.html";

            };
        }

        // function for log out

        function logout(e) {
            if (confirm("Are you sure")) {
                let user_id = "";
                localStorage.setItem("user_id", JSON.stringify(user_id));
                window.location.href = "../../index.html";
            }
        }


        let post_feedd = JSON.parse(localStorage.getItem("post_feedd"));

        //    filter data///////

        let filterpost = post_feedd.filter(post => post.unic_id == user_Id);
        console.log(filterpost);
        for (let i = 0; i < filterpost.length; i++) {




            //  <div class="post"> </div>
            div_post = document.createElement("div");

            div_post.setAttribute("class", "post");
            console.log(div_post);

            // /// for coment page/////////////////////////////////
            // let  post_id = filterpost.find(find_post);
            // function find_post(e) {
            //             return e.post_id == filterpost[i].post_id;
            //         }
            //     div_post.addEventListener("click", (event) => {
            //     const product_description = post_id;
            //     window.location.href = `./Product-uploaded .html?post_id=${product_description}`;
            // })

            //  <div class="user_list"> </div>
            div_user_list = document.createElement("div");
            div_user_list.setAttribute("class", "user_list");
            div_post.append(div_user_list);

            //  <div class="img"> </div>
            div_img = document.createElement("div");
            div_img.setAttribute("class", "img");
            div_user_list.append(div_img);

            //<a href="./details.html"></a>
            // a_img = document.createElement("a");
            // a_img.setAttribute("href", "./profile page/user profile/elon musk.html");
            // div_img.append(a_img);


            //  <img user profile/>
            img_a = document.createElement("img");
            img_a.setAttribute("src", filterpost[i].user_profile.img);
            img_a.setAttribute("alt", "profile");
            img_a.setAttribute("class", "profile_img");
            div_img.append(img_a);


            //  <div class="user"> </div>
            div_user = document.createElement("div");
            div_user.setAttribute("class", "user");
            div_user_list.append(div_user);


            // //<a href="./details.html"></a>
            // a_user = document.createElement("a");
            // a_user.setAttribute("href", "./profile page/user profile/elon musk.html");
            // div_user.append(a_user);

            //  <p> user name</p>
            p_user_name = document.createElement("p");
            p_user_name.setAttribute("class", "user_name")
            p_user_name.innerText = filterpost[i].user_name;
            div_user.append(p_user_name);


            //  span for delete button
            span_delete = document.createElement("span");
            span_delete.setAttribute("class", "delete");
            div_user.append(span_delete);

            // button for delete
            const delete_bn = document.createElement("button");
            delete_bn.setAttribute("class", "deletebn");
            delete_bn.innerText = "delete";
            delete_bn.setAttribute("id", filterpost[i].delete_bn)
            span_delete.append(delete_bn);

            delete_bn.addEventListener("click", function () {
                if (confirm("Are you sure to Delete ?")) {
                    let post_id = JSON.parse(localStorage.getItem("post_id"));
                    let post_feedd = JSON.parse(localStorage.getItem("post_feedd"));
                    function find_post(e) {
                        console.log(post_id);
                        return e.post_id == filterpost[i].delete_bn;;
                    }
                    user_data = post_feedd.find(find_post);
                    const indexOfUser = post_feedd.indexOf(user_data);
                    post_feedd.splice(indexOfUser, 1);
                    localStorage.setItem('post_feedd', JSON.stringify(post_feedd));
                };

                let reloadPage = false;
                if (!reloadPage) {
                    // Reload the page
                    location.reload();
                    reloadPage = true;
                }
            });



            //  <p> post cuntent</p>
            p_post_cuntent = document.createElement("p");
            p_post_cuntent.setAttribute("class", "post_cuntent")
            p_post_cuntent.innerText = filterpost[i]["post_content"];
            div_user.append(p_post_cuntent);

            if (filterpost[i].post_img.src) {

                //  <div class="post_img"> </div>
                post_post_img = document.createElement("div");
                post_post_img.setAttribute("class", "post_img");
                div_post.append(post_post_img);

                //  <img user post/>
                img_post = document.createElement("img");
                img_post.setAttribute("src", filterpost[i].post_img.src);
                img_post.setAttribute("alt", "post");
                post_post_img.append(img_post);

            }



            //  <div class="like_comand"> </div>
            div_like_comand = document.createElement("div");
            div_like_comand.setAttribute("class", "like_comand");
            div_post.append(div_like_comand);

            //  <div class="like"> </div>
            div_like = document.createElement("div");
            div_like.setAttribute("class", "like");
            div_like_comand.append(div_like);


            // <i for like
            i_like = document.createElement("i");
            i_like.setAttribute("class", "fa fa-heart-o");
            i_like.setAttribute("style", "font-size:18px;color: black;");
            div_like.append(i_like);

            // span like count
            span_like_count = document.createElement("span");
            span_like_count.setAttribute("class", "like_count");
            span_like_count.innerText = filterpost[i].like.count;
            div_like.append(span_like_count);

            //  <div class="comand"> </div>
            div_comand = document.createElement("div");
            div_comand.setAttribute("class", "comand");
            div_like_comand.append(div_comand);

            // <i for comand
            i_comand = document.createElement("i");
            i_comand.setAttribute("class", "fa fa-comment-o");
            i_comand.setAttribute("style", "font-size:18px;color: black;");
            div_comand.append(i_comand);

            // span comand count
            span_comand_count = document.createElement("span");
            span_comand_count.setAttribute("class", "like_count");
            span_comand_count.innerText = filterpost[i].like.count;
            div_comand.append(span_comand_count);

            document.querySelector(".left_side").append(div_post);

        }


        //  top user showing ///////
        let top_user_2 = JSON.parse(localStorage.getItem("user_list"));
        let top_user = top_user_2.filter((e) => e.user_name !== unic_user_id);

        user_profile = "../assets/img/user/DS profile img.jpg";

        for (let j = 0; j < top_user.length; j++) {

            let user_name = top_user[j]["first_name"] + " " + top_user[j]["last_name"];


            //  <div class="top_user"> </div>
            div_top_user = document.createElement("div");
            div_top_user.setAttribute("class", "top_user");

            //  <div class="img"> </div>
            div_img = document.createElement("div");
            div_img.setAttribute("class", "img");
            div_top_user.append(div_img);

            //  <img profile_img/>
            img_profile_img = document.createElement("img");
            img_profile_img.setAttribute("src", user_profile);
            img_profile_img.setAttribute("alt", "profile");
            img_profile_img.setAttribute("class", "profile_img")
            div_img.append(img_profile_img);

            //  <div class="user_list"> </div>
            div_user_list = document.createElement("div");
            div_user_list.setAttribute("class", "user_list");
            div_top_user.append(div_user_list);

            // <p tag for user name
            p_user_name = document.createElement("p");
            p_user_name.setAttribute("class", "user_name");
            p_user_name.innerText = user_name;
            div_user_list.append(p_user_name);

            //<span> tag for gray
            span_gray = document.createElement("span");
            span_gray.setAttribute("class", "gray");
            span_gray.innerText = top_user[j].user_name;
            div_user_list.append(span_gray);

            //div_follow_button /////

            div_follow_button = document.createElement("div");
            div_follow_button.setAttribute("class", "follow_button");
            div_top_user.append(div_follow_button);

            // button_follow

            button_follow = document.createElement("button");
            button_follow.setAttribute("id", top_user[j].user_name);
            let user_f_data=follow_data.find(e=>e.followee==unic_user_id && e.following==top_user[j].user_name);

            if(user_f_data==undefined){
                button_follow.innerText = "follow";
            }
            else{
                button_follow.innerText = "Unfollow";
            }
            
            div_follow_button.append(button_follow);


            // follow function

            button_follow.addEventListener("click",function(){
                let following=this.id;
                let followee=unic_user_id;

                let follow_bn=document.getElementById(following);
                let follow_data = JSON.parse(localStorage.getItem('follow_data'))||[];
                if(follow_data.length===0){
                    follow_data.push({
                        "following":following,
                        "followee":followee,
                        "notification":false
                    })
                    console.log(follow_data);
                    follow_bn.innerHTML = 'Unfollow';
                    localStorage.setItem("follow_data",JSON.stringify(follow_data));
                }
                else{
                    let user_f_data=follow_data.find(e=>e.followee==unic_user_id && e.following==following);
                let indexOfuser_f=follow_data.indexOf(user_f_data);
                if(user_f_data == undefined){
                    follow_data.push({
                        "following":following,
                        "followee":followee,
                        "notification":false
                    })
                    follow_bn.innerText="Unfollow";
                    localStorage.setItem("follow_data",JSON.stringify(follow_data));
                }
                else{
                    follow_data.splice(indexOfuser_f,1);
                    localStorage.setItem("follow_data",JSON.stringify(follow_data));
                    follow_bn.innerText="follow";
                }
                }
            });


            document.querySelector(".right_bottom").append(div_top_user);

        }







    </script>


  
</body>

</html>